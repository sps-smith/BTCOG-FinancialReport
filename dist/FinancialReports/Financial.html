<link type="text/css" rel="stylesheet" href="//unpkg.com/bootstrap/dist/css/bootstrap.min.css" />
<link type="text/css" rel="stylesheet" href="//unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.css" />
<link href="../siteassets/financialreports/financial.css?v=1.4" rel="stylesheet">

<div>
  <div id="app">
    <fn-select></fn-select>
    <fn-data></fn-data>
  </div>
</div>

<script src="http://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/datejs/1.0/date.min.js"></script>
<script src='https://cdn.polyfill.io/v2/polyfill.min.js'></script>
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<script src="https://unpkg.com/vuex"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.17.1/axios.min.js"></script>
<script src="https://unpkg.com/bootstrap-vue@latest/dist/bootstrap-vue.js"></script>
<script type="text/javascript" src="../siteassets/financialreports/Financial.js"></script>
<script>

var _select = Vue.component("fn-select",{
    template:'<div id="dvSelect">\
                <div>\
                  <span>Select Month: </span>\
                  <select v-model="selectedMonth">\
                    <option v-for="(mon, idx) in months" :value="idx">{{mon}}</option>\
                  </select>\
                </div>\
                <div class="dvYear">\
                  <span>Select Year: </span>\
                  <select v-model="selectedYear">\
                    <option v-for="(yer, idx) in years" :value="yer">{{yer}}</option>\
                  </select>\
                </div>\
                <div class="dvButtons">\
                  <b-button size="sm" variant="outline-success" @click="getfinance">Run Report</b-button>\
                  <b-button size="sm" variant="primary">Print Report</b-button>\
                </div>\
              </div>',
    data: function(){
        return{
            selectedMonth:0,
            selectedYear:0
        }
    },
    computed:{
        months: function(){
            return store.getters.getMonths;
        },
        years: function(){
            return store.getters.getYears;
        }
    },
    methods: {
        getfinance: function(){
            if (this.selectedMonth != "" && this.selectedYear != "")
                store.dispatch("GetFinanceData", {parm: this.selectedMonth, parm1: this.selectedYear});
        }
    }
})

var _finance = Vue.component("fn-data",{
    template: '<div id="dvFinance">\
                  <div class="financeTitle">\
                    <h3>Brampton triumphant church of god</h3>\
                    <h3>income & expenditure</h3>\
                    <h3>for the month of {{dte}}</h3>\
                  </div>\
                  <b-table v-if="revenueItems.length > 0" :items="revenueItems" :fields="revenueFields" foot-clone>\
                      <template slot="HEAD_week1" slot-scope="data">\
                          {{data.label}} <br/>\
                          {{selectedMonth}}/1 to {{selectedMonth}}/7\
                      </template>\
                      <template slot="HEAD_week2" slot-scope="data">\
                          {{data.label}} <br/>\
                          {{selectedMonth}}/8 to {{selectedMonth}}/14\
                      </template>\
                      <template slot="HEAD_week3" slot-scope="data">\
                          {{data.label}} <br/>\
                          {{selectedMonth}}/15 to {{selectedMonth}}/21\
                      </template>\
                      <template slot="HEAD_week4" slot-scope="data">\
                          {{data.label}} <br/>\
                          {{selectedMonth}}/22 to {{selectedMonth}}/28\
                      </template>\
                      <template v-if="weeks == 5" slot="HEAD_week5" slot-scope="data">\
                          {{data.label}} <br/>\
                          {{selectedMonth}}/29 to {{selectedMonth}}/{{days}}\
                      </template>\
                      <template slot="HEAD_Total" slot-scope="data">\
                          {{data.label}} \
                      </template>\
                  </b-table>\
                  <b-table v-if="expenseItems.length > 0" :items="expenseItems" :fields="revenueFields" foot-clone></b-table>\
              </div>',
    data: function(){
        return{
            revenueFields:["Revenue","week1", "week2", "week3", "week4", "week5", "total"]
        }
    },
    computed:{
        dte: function(){
            return store.getters.getPeriod;
        },
        revenueItems: function(){
            return store.getters.getRevenue;
        },
        expenseItems: function () {
            return store.getters.getExpense;
        },
        selectedMonth: function(){
            return store.getters.getSelectedMonth;
        },
        weeks: function(){
            return store.getters.getWeeks;
        },
        days: function(){
            return store.getters.getDays;
        }
    }
})

var app = new Vue({
    el: "#app",

})
</script>
